# Bayesian Sequential Subtree approach - part 1

## 1. `BASEML`

To calculate the branch lengths, the Hessian, and the gradient required for `MCMCtree` to approximate the likelihood calculation, we first need to run `BASEML`. In directory [`01_SeqBayes_S1/01_BASEML/02_Hessian`](../../01_SeqBayes_S1/01_BASEML/02_Hessian/README.md), you will find a `README.md` file with very detailed instructions about the steps we followed for this analysis:

* [Prepare the file structure to run `BASEML` on an HPC cluster](../../01_SeqBayes_S1/01_BASEML/02_Hessian/README.md#1-loading-data-to-the-hpc-and-set-working-environment): if you have gone through this repository, you will see that all the pipelines, code snippets, and various tools work under a specific file structure with the aim to improve data reproducibility. In the first part of the [aforementioned `README.md` file](../../01_SeqBayes_S1/01_BASEML/02_Hessian/README.md#1-loading-data-to-the-hpc-and-set-working-environment), you will learn how to set up the file structure we used to run `BASEML`.
* [Generate the `BASEML` input files](../../01_SeqBayes_S1/01_BASEML/02_Hessian/README.md#2-generate-baseml-files): next, you will follow various steps starting from generating the `tmp0001.ctl`, `tmp0001.txt`, and `tmp0001.tree` files needed to run `BASEML` to editing the control file (`tmp0001.ctl`) so that `method = 1` is specified instead of `method = 0`. As explained in the [PAML documentation](https://github.com/abacus-gene/paml/blob/master/doc/pamlDOC.pdf) (at the time of writing, page 56), the iteration algorithm enabled when setting `method = 1` is much more efficient with large datasets than the algorithm enabled when setting `method = 0`. Given that our mammal dataset is a large dataset, we decided to use `method = 1`.
* [Prepare a job array to run `BASEML`](../../01_SeqBayes_S1/01_BASEML/02_Hessian/README.md#3-preparing-bash-scripts-to-run-baseml): before explaining how we ran `BASEML` on an HPC cluster, we decided to include step-by-step guidelines for writing a script that specifies a job array, which we later show how to adapt to run `BASEML`. While our example is focused on a script that can be handled by an SGE scheduler, you can adapt the flags in the template script we provide you with so that it is compatible with other schedulers your HPC cluster may be using.
* [Run `BASEML`](../../01_SeqBayes_S1/01_BASEML/02_Hessian/README.md#3-preparing-bash-scripts-to-run-baseml): lastly, you will learn how the so-called `in.BV` file is generated when following our approach. We provide you with some code snippets that you can use to concatenate each `rst2` file output by `BASEML` for each alignment block (i.e., branch lengths, gradient, and Hessian are written out in the `rst2` file output by `BASEML`) to generate the `in.BV` file. Note that these blocks need to be appended in the same order as the corresponding alignment blocks appear in the input sequence file.

We have provided relevant input/output files which size is less than 100Mb (file size limit to be uploaded on a GitHub repository) in the following subdirectories:

* [Main tree hypothesis](00_BASEML/00_main_hypothesis): directory with the input/output files used/obtained when fixing our main tree topology (**T2**, "02_atlantogenata_tarver2016"; please [check the `README.md` file under `01_SeqBayes_S1/01_BASEML/01_trees` for more details](../../01_SeqBayes_S1/01_BASEML/01_trees/README.md)).
  * [`out_BASEML`](00_BASEML/00_main_hypothesis/out_BASEML/)
    * [`p01`](00_BASEML/00_main_hypothesis/out_BASEML/p01/): directory with the `BASEML` input control ([`tmp0001.ctl`](00_BASEML/00_main_hypothesis/out_BASEML/p01/tmp0001.ctl)) and tree ([`tmp0001.trees`](00_BASEML/00_main_hypothesis/out_BASEML/p01/tmp0001.trees)) files required to run `BASEML` and the [`rst2` output file](00_BASEML/00_main_hypothesis/out_BASEML/p01/rst2) that was generated for the first alignment block. Please note that the input sequence file (`tmp0001.txt`) is too large to be uploaded here, and so you can download it from [our Dropbox archive](https://www.dropbox.com/s/w6xnoleo4ssjalv/SeqBayesS1_BASEML_method1_T2hyp.zip?dl=0). Once you have downloaded and decompressed the file, please go to `000_Hessian/02_atlantogenata_tarver2016/p01/` to find the `tmp0001.txt` file. You shall find the rest of input/output files when using the first alignment block of our partitioned alignment.
    * [`p02`](00_BASEML/00_main_hypothesis/out_BASEML/p02/): directory with the input control ([`tmp0001.ctl`](00_BASEML/00_main_hypothesis/out_BASEML/p02/tmp0001.ctl)) and tree ([`tmp0001.trees`](00_BASEML/00_main_hypothesis/out_BASEML/p02/tmp0001.trees)) files required to run `BASEML` and the [`rst2` output file](00_BASEML/00_main_hypothesis/out_BASEML/p02/rst2) that was generated for the second alignment block. Please note that the input sequence file (`tmp0001.txt`) is too large to be uploaded here, and so you can download it from [our Dropbox archive](https://www.dropbox.com/s/w6xnoleo4ssjalv/SeqBayesS1_BASEML_method1_T2hyp.zip?dl=0). Once you have downloaded and decompressed the file, please go to `000_Hessian/02_atlantogenata_tarver2016/p02/` to find the `tmp0001.txt` file. You shall find the rest of input/output files when using the second alignment block of our partitioned alignment.
    * [`p03`](00_BASEML/00_main_hypothesis/out_BASEML/p03/): directory with the input control ([`tmp0001.ctl`](00_BASEML/00_main_hypothesis/out_BASEML/p03/tmp0001.ctl)) and tree ([`tmp0001.trees`](00_BASEML/00_main_hypothesis/out_BASEML/p03/tmp0001.trees)) files required to run `BASEML` and the [`rst2` output file](00_BASEML/00_main_hypothesis/out_BASEML/p03/rst2) that was generated for the third alignment block. Please note that the input sequence file (`tmp0001.txt`) is too large to be uploaded here, and so you can download it from [our Dropbox archive](https://www.dropbox.com/s/w6xnoleo4ssjalv/SeqBayesS1_BASEML_method1_T2hyp.zip?dl=0). Once you have downloaded and decompressed the file, please go to `000_Hessian/02_atlantogenata_tarver2016/p03/` to find the `tmp0001.txt` file. You shall find the rest of input/output files when using the third alignment block of our partitioned alignment.
    * [`p04`](00_BASEML/00_main_hypothesis/out_BASEML/p04/): directory with the input control ([`tmp0001.ctl`](00_BASEML/00_main_hypothesis/out_BASEML/p04/tmp0001.ctl)) and tree ([`tmp0001.trees`](00_BASEML/00_main_hypothesis/out_BASEML/p04/tmp0001.trees)) files required to run `BASEML` and the [`rst2` output file](00_BASEML/00_main_hypothesis/out_BASEML/p04/rst2) that was generated for the fourth alignment block. Please note that the input sequence file (`tmp0001.txt`) is too large to be uploaded here, and so you can download it from [our Dropbox archive](https://www.dropbox.com/s/w6xnoleo4ssjalv/SeqBayesS1_BASEML_method1_T2hyp.zip?dl=0). Once you have downloaded and decompressed the file, please go to `000_Hessian/02_atlantogenata_tarver2016/p04/` to find the `tmp0001.txt` file. You shall find the rest of input/output files when using the fourth alignment block of our partitioned alignment.
    * [`in.BV.02p1-p4`](00_BASEML/00_main_hypothesis/out_BASEML/in.BV.02p1-p4): `in.BV` file that was subsequently used by `MCMCtree` to approximate the likelihood calculation. You will see that there are four blocks of branch lengths, Hessian, and gradient (i.e., each block starts with a PHYLIP header with the amount of taxa: ` 72`). Each block corresponds to the content of the `rst2` file that was output for each of the four alignment blocks that are present in the partitioned sequence file that will be read by `MCMCtree` (i.e., the `rst2` files that you can find in the `p0[1-4]` directories aforementioned). The first block of branch lengths, Hessian, and gradient was estimated when reading the first alignment block (i.e., `p01`), the second block when reading the second alignment block (i.e., `p02`), etc. For more details about how this file was generated, please read [the last section of the `README.md` file under `01_SeqBayes_S1/01_BASEML/02_Hessian`](../../01_SeqBayes_S1/01_BASEML/02_Hessian/README.md#preparing-inbv-files-for-mcmctree).
* [Alternative tree hypotheses](00_BASEML/01_alternative_hypotheses/): directory with the `BASEML` input/output files we used/obtained when fixing the additional 6 tree hypotheses, which we referred to as **T1** ("atlantogenata_scandentia_primates_tarver2016"), **T3** ("03_atlantogenata_tarver2016_laurasiatheria_dosReis2012"), **T4** ("04_atlantogenata_tarver2016_laurasiatheria_ensembl"), **T5** ("05_ensembl"), **T6** ("06_xenarthra_tarver2016"), **T7** ("07_afrotheria_tarver2016"). Please [check the `README.md` file under `01_SeqBayes_S1/01_BASEML/01_trees` for more details on these hypotheses](../../01_SeqBayes_S1/01_BASEML/01_trees/README.md).
  * [`out_BASEML`](00_BASEML/01_alternative_hypotheses/out_BASEML/): as detailed above, we tested 6 additional tree hypotheses. Below, you can find a detailed explanation of the file structure of directory `T1` (first alternative tree hypothesis). Please note that the rest of directories for the other 5 additional hypotheses follow the same file structure, and thus are not repeated.
    * [**`T1`**](00_BASEML/01_alternative_hypotheses/out_BASEML/T1)
      * [`p01`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p01/): directory with the input control ([`tmp0001.ctl`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p01/tmp0001.ctl)) and tree ([`tmp0001.trees`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p01/tmp0001.trees)) files required to run `BASEML` and the [`rst2` output file](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p01/rst2) that was generated for the first alignment block. Please note that the input sequence file (`tmp0001.txt`) is too large to be uploaded here, and so you can download it from [our Dropbox archive](https://www.dropbox.com/s/gxy13v0y7fjoefo/SeqBayesS1_BASEML_method1_6treehyp.zip?dl=0). Once you have downloaded and decompressed the file, please go to `baseml_method1/01_atlantogenata_scandentia_primates_tarver2016/p01/` to find the `tmp0001.txt` file. You shall find the rest of input/output files when using the first alignment block of our partitioned alignment.
      * [`p02`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p02/): directory with the input control ([`tmp0001.ctl`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p02/tmp0001.ctl)) and tree ([`tmp0001.trees`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p02/tmp0001.trees)) files required to run `BASEML` and the [`rst2` output file](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p02/rst2) that was generated for the second alignment block. Please note that the input sequence file (`tmp0001.txt`) is too large to be uploaded here, and so you can download it from [our Dropbox archive](https://www.dropbox.com/s/gxy13v0y7fjoefo/SeqBayesS1_BASEML_method1_6treehyp.zip?dl=0). Once you have downloaded and decompressed the file, please go to `baseml_method1/01_atlantogenata_scandentia_primates_tarver2016/p02/` to find the `tmp0001.txt` file. You shall find the rest of input/output files when using the second alignment block of our partitioned alignment.
      * [`p03`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p03/): directory with the input control ([`tmp0001.ctl`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p03/tmp0001.ctl)) and tree ([`tmp0001.trees`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p03/tmp0001.trees)) files required to run `BASEML` and the [`rst2` output file](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p03/rst2) that was generated for the third alignment block. Please note that the input sequence file (`tmp0001.txt`) is too large to be uploaded here, and so you can download it from [our Dropbox archive](https://www.dropbox.com/s/gxy13v0y7fjoefo/SeqBayesS1_BASEML_method1_6treehyp.zip?dl=0). Once you have downloaded and decompressed the file, please go to `baseml_method1/01_atlantogenata_scandentia_primates_tarver2016/p03/` to find the `tmp0001.txt` files. You shall find the rest of input/output files when using the third alignment block of our partitioned alignment.
      * [`p04`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p04/): directory with the input control ([`tmp0001.ctl`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p04/tmp0001.ctl)) and tree ([`tmp0001.trees`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p04/tmp0001.trees)) files required to run `BASEML` and the [`rst2` output file](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/p04/rst2) that was generated for the fourth alignment block. Please note that the input sequence file (`tmp0001.txt`) is too large to be uploaded here, and so you can download it from [our Dropbox archive](https://www.dropbox.com/s/gxy13v0y7fjoefo/SeqBayesS1_BASEML_method1_6treehyp.zip?dl=0). Once you have downloaded and decompressed the file, please go to `baseml_method1/01_atlantogenata_scandentia_primates_tarver2016/p04/` to find the `tmp0001.txt` files. You shall find the rest of input/output files when using the fourth alignment block of our partitioned alignment.
    * [`in.BV.01p1-p4`](00_BASEML/01_alternative_hypotheses/out_BASEML/T1/in.BV.01.p1-4): `in.BV` file that was subsequently used by `MCMCtree` to approximate the likelihood calculation. You will see that there are four blocks of branch lengths, Hessian, and gradient (i.e., each block starts with a PHYLIP header with the amount of taxa: ` 72`). Each block corresponds to the content of the `rst2` file that was output for each of the four alignment blocks that are present in the partitioned sequence file that will be read by `MCMCtree` (i.e., the `rst2` files that you can find in the `p0[1-4]` directories aforementioned). The first block of branch lengths, Hessian, and gradient was estimated when reading the first alignment block (i.e., `p01`), the second block when reading the second alignment block (i.e., `p02`), etc. For more details about how this file was generated, please read [the last section of the `README.md` file under `01_SeqBayes_S1/01_BASEML/02_Hessian`](../../01_SeqBayes_S1/01_BASEML/02_Hessian/README.md#preparing-inbv-files-for-mcmctree).

## 2. `MCMCtree`

Once we had generated the `in.BV` files for each tree hypothesis, we were ready to run `MCMCtree`. In directory [`01_SeqBayes_S1/02_MCMCtree`](../../01_SeqBayes_S1/02_MCMCtree/README.md), you will find a `README.md` file with the following sections:

1. [Run `MCMCtree` when sampling from the prior](../../01_SeqBayes_S1/02_MCMCtree/README.md#prior): we provide an example of the control file that we used to run our analyses and explain how we ran `MCMCtree` for the main tree hypothesis and the additional 6 tree hypotheses.
2. [Run `MCMCtree` when sampling from the posterior](../../01_SeqBayes_S1/02_MCMCtree/README.md#posterior): if you have followed [our steps when parsing and filtering the dataset](../../01_SeqBayes_S1/00_Gene_filtering/README.md), you will have seen that we repeated our analyses when fixing our main tree hypothesis as we had to remove 11 nuclear genes that were common in our two main datasets (see [filtering step](../../01_SeqBayes_S1/00_Gene_filtering/README.md#54-remove-common-nuclear-genes-that-might-be-present-in-dataset-2) to generate two independent datasets for the analysis of this first step and the second step). To this end, we explain how we re-ran the analysis without these genes when fixing hypothesis `T2`. Nevertheless, we did not repeat the analyses when fixing the other 6 alternative hypotheses as we did not use them in the second step of this Bayesian Sequential Subtree approach: we had only one backbone tree following our main tree hypothesis `T2`.
3. [MCMC diagnostics](../../01_SeqBayes_S1/02_MCMCtree/README.md#2-checks): lastly, we explain the various checks that we carried out (qualitative and quantitative) to assess chain convergence.

We have provided relevant input/output files which size is less than 100Mb (file size limit to be uploaded on a GitHub repository) in the following subdirectories:

* [Main tree hypothesis](01_MCMCtree/00_main_hypothesis): directory with the `MCMCtree` input/output files we used/obtained when fixing our main tree topology (**T2**, "02_atlantogenata_tarver2016"; please [check the `README.md` file under `01_SeqBayes_S1/01_BASEML/01_trees` for more details](../../01_SeqBayes_S1/01_BASEML/01_trees/README.md)) and when sampling from both the prior and the posterior:
  * [Prior](01_MCMCtree/00_main_hypothesis/00_prior):
    * **Independent chains, directories `mcmc[1-5]`**: the pipeline we used to run `MCMCtree` soft-linked the input sequence file (i.e., `dummy_aln.aln`), the input tree file (i.e., `72sp_atlantogenata_tarver2016_MCMCtree_calib`), and the control file to run `MCMCtree` (i.e., `mcmctree_GBM_calibs_MAMMALS.ctl`; the pipeline we used when sampling from the prior did not change the control file name, hence why it kept the file name that normally is given when running from the posterior, please ignore) to each directory (i.e., see such files in directories `mcmc[1-5]`; there are five directories as we ran 5 chains). When we retrieved the data from the HPC cluster we used, we asked to download the original files that the soft links pointed to, hence why they are duplicated in each directory. Particularly, when sampling from the prior, the data are not used. Nevertheless, `MCMCtree` still needs to check that the taxa names in the input sequence file match those in the input tree file. In order to avoid reading the big alignment file with the four partitions (and thus save computing time), we used a "dummy" sequence file. To this end, `MCMCtree` spent less time reading the input sequence file and had everything required to check that the taxa names both input sequence and tree files are the same. You will find the seed numbers used to start every chain in the corresponding `mcmc[1-5]` directories in case you want to reproduce our analyses (i.e., see `SeedUsed` files under each `mcmc[1-5]` directory), as well as the inferred timetree for each MCMC (i.e., `FigTree.tre` files).
    * **Merging independent chains**: to merge the five independent chains that converged to the same target distribution into a unique file, we used [our in-house script `Combine_MCMC.sh`](01_MCMCtree/00_main_hypothesis/00_prior/Combine_MCMC.sh), which creates [directory `mcmc_files`](01_MCMCtree/00_main_hypothesis/00_prior/mcmc_files/) and outputs the [concatenated `mcmc_tracer.txt` file](01_MCMCtree/00_main_hypothesis/00_prior/mcmc_files/mcmc_tracer.txt) -- this script also creates `mcmc_clean.txt` files inside each `mcmc[1-5]` directory (i.e., in case an MCMC has not collected the samples specified in the control file, sometimes the last line gets truncated. If that occurred, the `mcmc_clean.txt` file would have this last truncated line deleted), but we have not uploaded them to save space; you can find them on [our Dropbox archive](https://www.dropbox.com/s/bum031cge8qp8sb/SeqBayesS1_MCMCtree_mainT2_prior.zip?st=39x02hry&dl=0). We then used a [template control file with `print = -1`](01_MCMCtree/00_main_hypothesis/00_prior/mcmc_files/mcmctree_GBM_calibs_MAMMALS.ctl) so that the collected samples across all the chains were used to generate [the output file with the inferred timetree](01_MCMCtree/00_main_hypothesis/00_prior/mcmc_files/FigTree.tre).
  * [Posterior](01_MCMCtree/00_main_hypothesis/01_posterior/):
    * **Independent chains, directories `run[1-4]`**: the pipeline we used to run `MCMCtree` soft-linked the input sequence file (i.e., `dummy.txt`), the input tree file (i.e., `tree.txt`, the original name was renamed in one of the steps of the pipeline), the `in.BV` file (i.e., the original file was renamed to `in.BV` during the pipeline, you can check that the files are the same by using command `diff`), and the control file to run `MCMCtree` (i.e., `mcmctree.ctl`) to each directory (i.e., see such files in directories `run[1-4]`; there are four directories as we ran 4 chains). When we retrieved the data from the HPC cluster we used, we asked to download the original files that the soft links pointed to, hence why they are duplicated in each directory. Note that, when running the approximate likelihood calculation,`MCMCtree` does not use the input sequence file: instead, the program uses the branch lengths, the Hessian, and the gradient saved in the `in.BV` file. Consequently, there is no need to use the big alignment file as the input sequence file because `MCMCtree` will take a substantial amount of time to read it. Instead, we used a "dummy" sequence file to speed up this process (i.e., `MCMCtree` just needs to verify that the taxa names are the same as those used in the input tree file, hence why using a "dummy" sequence file does the trick!). You will find the seed numbers to start every chain in the corresponding `run[1-4]` directories in case you want to reproduce our analyses (i.e., see `SeedUsed` files under each `run[1-4]` directory), as well as the inferred timetree for each MCMC (i.e., `FigTree.tre` files).
    * **Merging independent chains**: to merge the four independent chains that converged to the same target distribution into a unique file, we used [our in-house script `Combine_MCMC.sh`](01_MCMCtree/00_main_hypothesis/01_posterior/Combine_MCMC.sh), which creates [directory `mcmc_files`](01_MCMCtree/00_main_hypothesis/01_posterior/mcmc_files/) and outputs the [concatenated `mcmc_tracer.txt` file](01_MCMCtree/00_main_hypothesis/01_posterior/mcmc_files/mcmc_tracer.txt) -- this script also creates `mcmc_clean.txt` files inside each `run[1-4]` (i.e., in case an MCMC has not collected the samples specified in the control file, sometimes the last line gets truncated. If that occurred, the `mcmc_clean.txt` file would have this last truncated line deleted), but we have not uploaded them to save space; you can find them on [our Dropbox archive](https://www.dropbox.com/s/53mdfyc47hukkrh/SeqBayesS1_MCMCtree_mainT2_posterior_newchrono.zip?dl=0). We then used a [template control file with `print = -1`](01_MCMCtree/00_main_hypothesis/01_posterior/mcmc_files/mcmctree.ctl) so that the collected samples across all the chains were used to generate [the output file with the inferred timetree](01_MCMCtree/00_main_hypothesis/01_posterior/mcmc_files/FigTree.tre). **Please note that this is the timetree that we used as a backbone tree, which was also used to generate [Fig 2c in our paper (Álvarez-Carretero et al. 2022)](https://www.nature.com/articles/s41586-021-04341-1)**.
* [Alternative tree hypotheses](01_MCMCtree/01_alternative_hypotheses): directory with the `MCMCtree` input/output files we used/obtained when fixing the other 6 alternative hypotheses (i.e., **T1** "atlantogenata_scandentia_primates_tarver2016", **T3** "03_atlantogenata_tarver2016_laurasiatheria_dosReis2012", **T4** "04_atlantogenata_tarver2016_laurasiatheria_ensembl", **T5** "05_ensembl", **T6** "06_xenarthra_tarver2016", **T7** "07_afrotheria_tarver2016") and when sampling from both the prior and the posterior:
  * [Prior](01_MCMCtree/01_alternative_hypotheses/00_prior/):
    * **Independent chains, directories `T[1,3-7]/mcmc[1-5]`**: the pipeline we used to run `MCMCtree` did not soft-link input files to the directories where the program ran -- we used relative paths this time to avoid creating new files! Inside each `mcmc[1-5]` directory for each tree hypothesis, you will find the control file to run `MCMCtree` (i.e., `mcmctree.ctl`). If you open these files, you will see that options `seqfile` and `treefile` include relative paths to both the input sequence and tree files, respectively, according to the file structure we kept in the HPC cluster we used. Given that we ran 5 chains, you will see that there are 5 directories `mcmc[1-5]`. You will find the seed numbers to start every chain in the corresponding `mcmc[1-5]` directories in case you want to reproduce our analyses (i.e., see `SeedUsed` files under each `mcmc[1-4]` directory), as well as the inferred timetree for each MCMC (i.e., `FigTree.tre` files). You can also download all the input and output files from [our Dropbox archive](https://www.dropbox.com/s/jb3ppzpw543eg72/SeqBayesS1_MCMCtree_6treehyp_MCMCtree_prior.zip?dl=0).
  * [Posterior](01_MCMCtree/01_alternative_hypotheses/01_posterior/):
    * **Independent chains, directories `mcmc[1-10]`**: the pipeline we used to run `MCMCtree` soft-linked the input sequence file (i.e., `alignment_4parts.aln`, which we deleted when we downloaded the data from the HPC cluster we used as it is [a very large file](https://www.dropbox.com/s/mrvzzvd4o6qqyqk/000_alignments.zip?st=pwt3encq&dl=0)), the input tree file (i.e., one different file for each of the 6 tree topologies tested), the `in.BV` file (i.e., the original files that you will see for each hypothesis in [the `out_BASEML` directory described above](00_BASEML/01_alternative_hypotheses/out_BASEML/) were renamed to `in.BV` during the pipeline, you can check that the files are the same by using command `diff`), and the control file to run `MCMCtree` (i.e., `mcmctree_GBM_calibs_MAMMALS.ctl`) to each directory (i.e., see such files in directories `mcmc[1-10]`; there are ten directories as we ran 10 chains). When we retrieved the data from the HPC cluster we used, we asked to download the original files that the soft links pointed to except for those links pointing to the large sequence alignment file, hence why they are not in each directory.
    * **Merging independent chains**: to merge the four independent chains that converged to the same target distribution into a unique file, we used [our in-house script `Combine_MCMC.sh`](01_MCMCtree/00_main_hypothesis/01_posterior/Combine_MCMC.sh), which creates a directory called `mcmc_files`. Note that we have not uploaded this directory given that the `mcmc_tracer.txt` output files for each tree hypothesis are larger than 100Mb. We have not uploaded the `mcmc_clean.txt` files that were also generated inside each `mcmc[1-10]` directory to save space. Please find these files in [our Dropbox archive](https://www.dropbox.com/s/09u8l81dgw166do/SeqBayesS1_MCMCtree_6treehyp_MCMCtree.zip?dl=0). Nevertheless, we have uploaded the timetrees inferred with the samples collected by the chains that converged to the same target distribution in directory [`FigTree_files_al_6hyp`](01_MCMCtree/01_alternative_hypotheses/01_posterior/FigTree_files_all_6hyp/). **Please note that these are the timetrees that we used to generate [Fig 2c in our paper  (Álvarez-Carretero et al. 2022=](https://www.nature.com/articles/s41586-021-04341-1)**.
